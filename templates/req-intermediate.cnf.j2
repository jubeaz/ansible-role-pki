{{ ansible_managed | comment }}
.include {{ _ca_dirs['_ca_cnf'].path }}/openssl-base.cnf

[ req ]
output_password             = test
encrypt_key                 = yes
default_keyfile             = $b_private_key

default_bits                = 4096
default_md                  = sha256

prompt                      = no
distinguished_name          = req_dn
string_mask                 = utf8only
x509_extensions             = v3_ext

[ req_dn ]
{% for key, value in ca_dn.items() %}
{{ key }} = {{ value }}
{% endfor %}

[ v3_ext ]
subjectKeyIdentifier        = hash
authorityKeyIdentifier      = keyid:always,issuer
basicConstraints            = critical, CA:true
keyUsage                    = critical, cRLSign, keyCertSign

